<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="facturaVenta_det" pageWidth="555" pageHeight="802" columnWidth="555" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="089c66e1-0af6-4731-a486-b53aba1b2c64">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="factura" class="java.lang.Integer"/>
	<parameter name="prefijo" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT VEN.NRO_PREFIJO, VEN.NRO_FACTURA, VEN.PRECIO_TOTAL, COALESCE(VEN.IVA5,0) AS IVA5, COALESCE(VEN.IVA10,0) AS IVA10, VEN.FECHA,  VEN.VENCIMIENTO, VEN.PAGO_CONTADO, VEN.DESCUENTO, CLI.NOMBRE || ' ' || COALESCE(CLI.APELLIDO,'') AS CLIENTE,
case when CLI.dv='' then CLI.cedula else CLI.cedula ||'-'|| CLI.dv end as RUC, CLI.DIRECCION,
DET_VEN.CANTIDAD AS CANT_DET, DET_VEN.CODIGO, DET_VEN.DESCRIPCION, DET_VEN.CANTIDAD,
DET_VEN.PRECIO_UNITARIO, DET_VEN.SUB_TOTAL, DET_VEN.EXENTAS, COMP.TIPO_IVA
FROM
VENTA VEN
JOIN DETALLE_VENTA DET_VEN ON (VEN.VENTA_ID=DET_VEN.VENTA_ID)
JOIN CLIENTE CLI ON (VEN.CLIENTE_ID=CLI.CLIENTE_ID)
JOIN COMPONENTES COMP ON (DET_VEN.CODIGO=COMP.CODIGO)
WHERE  VEN.NRO_FACTURA=$P{factura} AND VEN.NRO_PREFIJO=$P{prefijo}]]>
	</queryString>
	<field name="nro_prefijo" class="java.lang.String"/>
	<field name="nro_factura" class="java.lang.Integer"/>
	<field name="precio_total" class="java.lang.Integer"/>
	<field name="iva5" class="java.lang.Integer"/>
	<field name="iva10" class="java.lang.Integer"/>
	<field name="fecha" class="java.sql.Timestamp"/>
	<field name="vencimiento" class="java.sql.Date"/>
	<field name="pago_contado" class="java.lang.String"/>
	<field name="descuento" class="java.lang.Integer"/>
	<field name="cliente" class="java.lang.String"/>
	<field name="ruc" class="java.lang.String"/>
	<field name="direccion" class="java.lang.String"/>
	<field name="cant_det" class="java.lang.Integer"/>
	<field name="codigo" class="java.lang.String"/>
	<field name="descripcion" class="java.lang.String"/>
	<field name="cantidad" class="java.lang.Integer"/>
	<field name="precio_unitario" class="java.lang.Integer"/>
	<field name="sub_total" class="java.lang.Integer"/>
	<field name="exentas" class="java.lang.Integer"/>
	<field name="tipo_iva" class="java.lang.Integer"/>
	<variable name="iva5" class="java.lang.Integer">
		<variableExpression><![CDATA[($F{precio_unitario}/21)]]></variableExpression>
	</variable>
	<variable name="iva10" class="java.lang.Integer">
		<variableExpression><![CDATA[$F{precio_unitario}/11]]></variableExpression>
	</variable>
	<detail>
		<band height="15" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="0" y="0" width="56" height="15" uuid="6443a524-1748-4782-8988-af5a0b6d49e3"/>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="10" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cantidad}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="57" y="0" width="244" height="15" uuid="67e436e6-124a-447f-a5c2-ea2ebe3fca36"/>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Left">
					<font fontName="Arial" size="10" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{descripcion}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="437" y="0" width="56" height="15" uuid="1333b443-c9fa-4746-b0be-da217f50f25d">
					<printWhenExpression><![CDATA[$F{tipo_iva}==1]]></printWhenExpression>
				</reportElement>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="10" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{iva5}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="494" y="0" width="57" height="15" uuid="6d6182d8-ae8a-44a6-b105-7d8e458bcba0">
					<printWhenExpression><![CDATA[$F{tipo_iva}==0]]></printWhenExpression>
				</reportElement>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="10" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{iva10}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="378" y="0" width="58" height="15" uuid="fb080607-aa77-44db-a1b1-e9218bbd24fb">
					<printWhenExpression><![CDATA[$F{tipo_iva}==2]]></printWhenExpression>
				</reportElement>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="10" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{exentas}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="302" y="0" width="75" height="15" uuid="e68bb5a6-d22a-4393-9be3-0178fb104239"/>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.0"/>
					<bottomPen lineWidth="0.0"/>
				</box>
				<textElement textAlignment="Center">
					<font fontName="Arial" size="10" isItalic="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{precio_unitario}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
